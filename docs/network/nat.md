
# 使用钉钉开放平台进行内网穿透

> 最近在写微信小程序，由于小程序需要实时在手机上调试的原因，不能像在PC上使用 `localhost` 进行调试，所以了解到了内网穿透的功能。

![dingding.png](https://i.loli.net/2020/04/13/DEnsmrA3aiOZJ6u.png)

 **钉钉的内网穿透机制流程**

---

## 介绍

 > 内网穿透：简单点来说就是内部局域网络，通过映射端口，可以让外网的计算机通过映射的端口来访问内部的局域网。

 以微信小程序的例子来介绍一下场景，小程序分为前台和后台。
 
 - 前台
  
   小程序的前台作为单独的服务进行部署后，与后台服务进行交互，此时如果是在本地PC进行开发，完全可以以 `localhost:port/app` 请求路径来处理，而如果开启了 `真机调试` 后，前端服务无法在微信小程序中
   调用 `localhost` 的服务。
 
 - 后台
 
   此时如果开发者没有购买服务器以及域名（小程序中出现的域名都要备案和使用SSL证书），可以跳到下面的使用环节 👇。
 
---

## 使用

 使用起来真的挺简单的，很快容易上手。
 
 首先访问 `https://github.com/open-dingtalk/pierced` ，选择适合自己的平台，并且将文件下载到本地的用户文件夹中。
 
 以Windows为例子，路径为 `C:\Users\Admin` 下，下载完成后，进入 `cmd`，运行如下命令。
 
 ```bash
    ding -subdomain=yourwebsite port
 ```
 
 - yourwebsite是你需要映射出去的二级域名
 - port是本地服务的端口名
 
 如果出现Successfully提示后，就可以通过 `youwebsite.vaiwan.com` 来访问本机服务了。
 
---

## 总结

 虽然使用钉钉提供的内网穿透服务来进行微信小程序开发有点不合常理，但是程序是没有国界的，好用才是硬道理。
 
 有兴趣的同学也可以了解一下 `ngrok` 。
